trigger:
- none

pool:
  name: Agentpool    
  demands:
    - agent.name -equals agentjdid


steps:
  

- script: |
     chmod +x ./gradlew
  displayName: 'Set JAVA_HOME to Java 11 and Grant execute permissions to Gradle wrapper'

- task: Gradle@3
  inputs:
    wrapperScript: 'gradlew'
    tasks: 'build'
    javaHomeOption: 'Path'
    jdkDirectory: '$(JAVA_HOME)'
    workingDirectory: ''
    gradleOptions: ''
    sonarQubeRunAnalysis: false
  displayName: 'Build the Android project'

- task: Gradle@3
  inputs:
    wrapperScript: 'gradlew'
    tasks: 'test'
    javaHomeOption: 'Path'
    jdkDirectory: '$(JAVA_HOME)'
    workingDirectory: ''
    gradleOptions: ''
    sonarQubeRunAnalysis: false
  displayName: 'Run unit tests'

- task: CopyFiles@2
  inputs:
    contents: '**/*.apk'
    targetFolder: '$(build.artifactStagingDirectory)'

- task: PublishBuildArtifacts@1
  inputs:
    pathToPublish: '$(build.artifactStagingDirectory)'
    artifactName: 'drop'
